<script>
  // Safe year setter (won't error if #year doesn't exist)
  const yearEl = document.getElementById("year");
  if (yearEl) yearEl.textContent = new Date().getFullYear();

  // Only run reveal where it's enabled
  if (document.body.classList.contains("reveal-on")) {
    const cards = document.querySelectorAll(".arch-card");

    if (!("IntersectionObserver" in window)) {
      cards.forEach((c) => c.classList.add("is-visible"));
    } else {
      const io = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add("is-visible");
              io.unobserve(entry.target);
            }
          });
        },
        { threshold: 0.1, rootMargin: "0px 0px -10% 0px" }
      );

      cards.forEach((c) => io.observe(c));
    }
  }
</script>
